# signal-timing-optimization-with-DQN-for-CAV-and-HV-scenories
背景：自动驾驶与人类驾驶在道路上混行，自动驾驶车辆未来可以与基础设施实时交互，为未来智能交通的信号灯配时运营作此研究。
当前的问题：动态车流在静态信号灯控制下有不必要的延误
解决方案：自适应信号灯控制系统。
实现方法：DQN加强学习使用神经网络来表示最优策略的函数，状态：排队和车流量，动作：优化相位配时，奖励：变化的排队长度和延误（dqn对于但路口已足够稳定和样本高效性）
产生的影响：车辆通行时间和停下的频率变少。未来提供实时数据的是自动驾驶车，对自动驾驶的积极影响显著，自动驾驶有规则的跟车距离，温和的加速减速，可被预测和统计，若基础设施环境对自动驾驶友好，人类驾驶也会模仿自动驾驶的跟车规律，形成安全整体高效的驾驶环境。
适用性：独立的路口、路网。
创新点：研究自动驾驶混行后，对路口整体车辆通行的影响。所以设置有cav和无cav优化组和无cav无优化组三组对照。考虑到轨迹数据仅反映人类驾驶车辆(HV)的实际局限性，本研究利用真实的HV数据来建立现实的基准流量和转向比率。通过引入VISSIM模拟中不同连接和自动化车辆(CAV)的假设渗透率，我们分析了通过强化学习实现的自适应信号控制策略的潜在优势。CAV被建模为具有缩短车距、更快的反应速度和实时信息共享，从而体现了它们与传统HV所缺乏的协同能力。
研究步骤：1.	确定路口范围，筛选出路口车轨迹数据
2.	各个时间周期的车流量 和不同路径的车流量
3.	确定车辆进入方向进转向比例
4.	确定实际的排队长度 红灯时间的到达车辆率✖红灯时间再包括上一周期绿灯残留车辆数
5.	反映现实世界的交通现象，验证在周期范围内车辆跟车模型 通过队列长度作为特征值来验证精度，

#数据用来车辆在行驶过程中如何根据前车的行为（如速度、距离）来调整自身的速度和加速度，仿真真实世界尽可能重现数据，同时适用改变信号灯条件后的微观驾驶行为。
<img width="352" height="630" alt="image" src="https://github.com/user-attachments/assets/8a13c739-6f89-4b0b-9dc4-03f848ce4893" />
图片中数据完善就可以完成模拟配置，当然还包括信号灯相位配置
<img width="930" height="334" alt="image" src="https://github.com/user-attachments/assets/7335bba5-8ae2-47ce-a607-d995e5b0e78b" />
这张图是确定的路口范围
##一、清洗数据 确保数据的准确性和可用性  原始轨迹文件包含8：30-9：00区域早高峰的全部类型交通用工具数据且每个编号的交通工具占一行，每个轨迹点混在一行，所以先分行成每一个轨迹点一行，总共有670万+行数据，只筛出租车和家用车获得400万+数据，用此数据获得热力图（位置上车辆出现的频率），选取一个较为拥堵和交通量大的路口，筛选该路口范围内的数据，获得63万+数据，开始研究，取南北，东西进口道的停止线50m和100m的数据，划定矩形范围，用python统计通过矩形起始线的每300s时间间隔车辆数，继而获得到达流量，用于vissim输入。因为vissim仿真需要验证指标，选取最大排队长度作为指标，符合vissim队列计算逻辑，依然用python遍历每一秒的队列中的排队车辆取300s一个周期的最大值，获得最大队列表。在vissim中在实际道路处构建仿真道路信息设置交通工具驾驶人行为参数，信号灯相位，跟车模型，运行模拟得到最大排队长度，计算误差指标rmse<10%，仿真效果优良。
